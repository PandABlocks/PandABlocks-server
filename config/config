# Interface definition
#
# Notes:
#   bit_out definitions correspond to a bit on the system bus

TTLIN[6]
    bit_out VAL
    param   TERM            enum 2
        0   High-Z
        1   50-Ohm

TTLOUT[10]
    param   VAL             bit_mux

LVDSIN[2]
    bit_out VAL

LVDSOUT[2]
    param   VAL             bit_mux

LUT[8]
    param   INPA            bit_mux
    param   INPB            bit_mux
    param   INPC            bit_mux
    param   INPD            bit_mux
    param   INPE            bit_mux
    bit_out VAL
    param   FUNC            lut

SRGATE[4]
    param   SET             bit_mux
    param   RESET           bit_mux
    bit_out VAL
    param   SET_EDGE        enum 2
        0   Falling
        1   Rising
    param   RESET_EDGE      enum 2
        0   Falling
        1   Rising
    write   FORCE_STATE     bit

DIV[4]
    param   INP             bit_mux
    param   RESET           bit_mux
    bit_out OUTD
    bit_out OUTN
    param   FIRST_PULSE     enum 2
        0   OutN
        1   OutD
    param   DIVISOR
    read    COUNT
    write   FORCE_RESET     action

PULSE[4]
    param   INP             bit_mux
    param   RESET           bit_mux
    bit_out OUT
    bit_out PERR
    time    DELAY
    time    WIDTH
    write   FORCE_RESET     action
    read    STATE           enum 1
        0   State
    read    MISSED_CNT

SEQ[4]
    param   GATE            bit_mux
    param   INPA            bit_mux
    param   INPB            bit_mux
    param   INPC            bit_mux
    param   INPD            bit_mux
    bit_out OUTA
    bit_out OUTB
    bit_out OUTC
    bit_out OUTD
    bit_out OUTE
    bit_out OUTF
    bit_out ACTIVE
    param   PRESCALE
    param   TABLE_LENGTH    uint 511
    write   SOFT_GATE       bit
    read    CUR_FRAME
    read    CUR_FCYCLE
    read    CUR_TCYCLE
    read    TABLE_CYCLE
    short_table   TABLE
        11:0    NREPEATS
        15:12   INPUT_MASK
        19:16   TRIGGER_MASK
        25:20   OUT_PH_A
        31:26   OUT_PH_B
        47:32   TIME_PH_A
        63:48   TIME_PH_B

INENC[4]
    bit_out A
    bit_out B
    bit_out Z
    bit_out CONN
    pos_out ENC_POSN
    param   PROTOCOL        enum 5
        0   Quadrature
        1   SSI
        2   BISS
        3   enDat
        4   enDat/BISS
    param   RATE
    param   BITS            uint 63
    param   RST_ON_Z        bit
    write   SETP

QDEC[4]
    param   A               bit_mux
    param   B               bit_mux
    param   Z               bit_mux
    pos_out ENC_POSN
    param   RST_ON_Z        bit
    param   SETP            position

OUTENC[4]
    param   A               bit_mux
    param   B               bit_mux
    param   Z               bit_mux
    param   ENC_POSN        pos_mux
    param   CONN            bit_mux
    param   PROTOCOL        enum 5
        0   Pos-Quad
        1   SSI
        2   BISS
        3   enDat
        4   ABZ
    param   BITS
    param   QPRESCALAR      enum 1
        0   Something
    write   FORCE_QSTATE    action
    read    QSTATE          bit

POSENC[4]
    param   ENC_POSN        pos_mux
    bit_out A
    bit_out B
    param   QPRESCALAR      bit
    param   MODE            enum 2
        0   quadrature
        1   step+direction
    write   FORCE_QSTATE    action
    read    QSTATE          bit

CALC[2]
    param   A               pos_mux
    param   B               pos_mux
    pos_out RESULT
    param   KA
    param   KB
    param   SCALE

# Hard wired inputs!
ADDER
    pos_out RESULT
    param   MASK
    param   OUTSCALE

COUNTER[8]
    param   ENABLE          bit_mux
    param   TRIGGER         bit_mux
    param   DIR             bit_mux
    pos_out COUNTN
    bit_out CARRY
    param   START
    param   STEP
    write   SOFT_ENABLE

PGEN[2]
    param   ENABLE          bit_mux
    param   TRIGGER         bit_mux
    pos_out POSN
    param   SAMPLES
    param   CYCLES
    table   TABLE

PCOMP[4]
    param   ENABLE          bit_mux
    param   POSN            pos_mux
    bit_out ACT
    bit_out PULSE
    param   START
    param   STEP
    param   WIDTH
    param   NUM
    param   RELATIVE
    param   LUT_ENABLE
    table   TABLE

ADC[8]
    param   TRIGGER         bit_mux
    param   RESET           bit_mux
    bit_out TRIGGERD
    pos_out DATA

PCAP
    param   ENABLE          bit_mux
    param   TRIG_POS        bit_mux
    param   TRIG_ADC        bit_mux
    param   MASK

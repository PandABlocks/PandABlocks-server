# Interface definition
#
# Notes:
#   bit_out definitions correspond to a bit on the system bus

TTLIN[6]
    bit_out VAL
    param   TERM            enum
        enums
            0   High-Z
            1   50-Ohm

TTLOUT[10]
    bit_in  VAL

LVDSIN[2]
    bit_out VAL

LVDSOUT[2]
    bit_in  VAL

LUT[8]
    bit_in  INPA
    bit_in  INPB
    bit_in  INPC
    bit_in  INPD
    bit_in  INPE
    bit_out VAL
    param   FUNC            lut

SRGATE[4]
    bit_in  SET
    bit_in  RESET
    bit_out VAL
    param   SET_EDGE        enum
        enums
            0   Falling
            1   Rising
    param   RESET_EDGE      enum
        enums
            0   Falling
            1   Rising
    write   FORCE_STATE     bit

DIV[4]
    bit_in  INP
    bit_in  RESET
    bit_out OUTD
    bit_out OUTN
    param   FIRST_PULSE     enum
        enums
            0   OutN
            1   OutD
    param   DIVISOR
    read    COUNT
    write   FORCE_RESET     action

PULSE[4]
    bit_in  INP
    bit_in  RESET
    bit_out OUT
    bit_out PERR
    param   DELAY           scaled_time
    param   WIDTH           scaled_time
    param   PRESCALE
    write   FORCE_RESET     action
    read    STATE           enum
    read    MISSED_CNT

SEQ[4]
    bit_in  GATE
    bit_in  INPA
    bit_in  INPB
    bit_in  INPC
    bit_in  INPD
    bit_out OUTA
    bit_out OUTB
    bit_out OUTC
    bit_out OUTD
    bit_out OUTE
    bit_out OUTF
    bit_out ACTIVE
    param   PRESCALE
    param   TABLE_LENGTH    int
    write   SOFT_GATE       bit
    read    CUR_FRAME
    read    CUR_FCYCLE
    read    CUR_TCYCLE
    read    TABLE_CYCLE
    table   TABLE

INENC[4]
    bit_out A
    bit_out B
    bit_out Z
    bit_out CONN
    pos_out ENC_POSN
    param   PROTOCOL        enum
        enum
            0   Quadrature
            1   SSI
            2   BISS
            3   enDat
            4   enDat/BISS
    param   RATE
    param   BITS            uint 63
    param   RST_ON_Z        bit
    write   SETP

QDEC[4]
    bit_in  A
    bit_in  B
    bit_in  Z
    pos_out ENC_POSN
    param   RST_ON_Z        bit
    write   SETP            position

OUTENC[4]
    bit_in  A
    bit_in  B
    bit_in  Z
    pos_in  ENC_POSN
    bit_in  CONN
    param   PROTOCOL        enum
        enum
            0   Pos-Quad
            1   SSI
            2   BISS
            3   enDat
            4   ABZ
    param   BITS
    param   QPRESCALAR      enum
    write   FORCE_QSTATE    action
    read    QSTATE          bit

POSENC[4]
    pos_in  ENC_POSN
    bit_out A
    bit_out B
    param   QPRESCALAR      bit
    param   MODE            enum
        enums
            0   quadrature
            1   step+direction
    write   FORCE_QSTATE    action
    read    QSTATE          bit

CALC[2]
    pos_in  A
    pos_in  B
    pos_out RESULT
    param   KA
    param   KB
    param   SCALE

# Hard wired inputs!
ADDER
    pos_out RESULT
    param   MASK
    param   OUTSCALE

COUNTER[8]
    bit_in  ENABLE
    bit_in  TRIGGER
    bit_in  DIR
    pos_out COUNTN
    bit_out CARRY
    param   START
    param   STEP
    write   SOFT_ENABLE

PGEN[2]
    bit_in  ENABLE
    bit_in  TRIGGER
    pos_out POSN
    param   SAMPLES
    param   CYCLES
    table   TABLE

PCOMP[4]
    bit_in  ENABLE
    pos_in  POSN
    bit_out ACT
    bit_out PULSE
    param   START
    param   STEP
    param   WIDTH
    param   NUM
    param   RELATIVE
    param   LUT_ENABLE
    table   TABLE

ADC[8]
    bit_in  TRIGGER
    bit_in  RESET
    bit_out TRIGGERD
    pos_out NUMSAMPLES
#     adc_out DATA

PCAP
    bit_in  ENABLE
    bit_in  TRIG_POS
    bit_in  TRIG_ADC
    param   MASK
